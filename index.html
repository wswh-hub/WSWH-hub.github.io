<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProgressPal</title>
    <style type="text/css">
        html,body{margin:0;padding:0;height:100%;overflow:hidden;}
        body{
            background:url('denglu.jpg') center/cover no-repeat;
            min-height:100vh;
        }
        .boxleft{
            float:left;
            margin:100px 0 0 200px;
            color:white;
            font-size:80px;
            font-weight:bold;
        }
        .box{
            float:right;
            margin:100px 120px 0 0;
            width:480px;
            height:580px;
            background:rgb(153,134,182);
            border-radius:20px;
            text-align:center;
            padding-top:50px;
            box-sizing:border-box;
            color:white;
        }
        .box input{
            width:400px;
            height:70px;
            background:aqua;
            border-radius:30px;
            border:none;
            font-size:35px;
            padding:0 20px;
            margin:40px auto;
            display:block;
        }
        .message{
            color:white;
            font-size:25px;
            margin:10px auto;
            width:400px;
            text-align:center;
            padding:10px;
            border-radius:10px;
            display:none;
        }
        .success{background:rgba(76,175,80,0.8);}
        .error{background:rgba(244,67,54,0.8);}
        button{
            width:400px;
            height:70px;
            background:#4CAF50;
            color:white;
            border:none;
            border-radius:30px;
            font-size:35px;
            cursor:pointer;
            margin:40px auto;
            display:block;
        }
        .switch-btn{background:#2196F3;font-size:30px;height:60px;}
        #registerForm{display:none;}
        h1{font-size:6rem;margin:0.5em 0;text-align:center;color:white;}
    </style>
</head>

<body>
<h1>Welcome to ProgressPal</h1>
<div class="boxleft">è¿›æ­¥ä¼™ä¼´<br>&emsp;&emsp;ä½ çš„æˆé•¿è®°å½•è€…</div>

<div class="box">
    <!-- ç™»å½•è¡¨å• -->
    <div id="loginForm">
        <div>è¯·ç™»å½•è´¦å·</div>
        <div id="loginMessage" class="message"></div>
        <input type="text" id="loginPhone" placeholder="æ‰‹æœºå·">
        <input type="password" id="loginPassword" placeholder="å¯†ç ">
        <button id="loginBtn">ç™»å½•</button>
        <button class="switch-btn" id="showRegisterBtn">æ–°ç”¨æˆ·æ³¨å†Œ</button>
    </div>
    
    <!-- æ³¨å†Œè¡¨å• -->
    <div id="registerForm">
        <div>ç”¨æˆ·æ³¨å†Œ</div>
        <div id="registerMessage" class="message"></div>
        <input type="text" id="registerPhone" placeholder="æ‰‹æœºå·">
        <input type="password" id="registerPassword" placeholder="å¯†ç ">
        <input type="password" id="registerConfirmPassword" placeholder="ç¡®è®¤å¯†ç ">
        
        <!-- æ³¨å†ŒæˆåŠŸæ˜¾ç¤º -->
        <div id="successMessage" style="display:none;color:white;font-size:30px;margin:20px;">
            <p>ğŸ‰ æ³¨å†ŒæˆåŠŸï¼</p>
            <p>æ‰‹æœºå·ï¼š<span id="registeredPhone"></span></p>
            <p>è¯·è®°ä½ä½ çš„å¯†ç </p>
        </div>
        
        <button id="registerBtn">æ³¨å†Œ</button>
        <button class="switch-btn" id="showLoginBtn">è¿”å›ç™»å½•</button>
    </div>
</div>

<script>
// å…ƒç´ 
const loginForm=document.getElementById('loginForm'),
      registerForm=document.getElementById('registerForm'),
      showRegisterBtn=document.getElementById('showRegisterBtn'),
      showLoginBtn=document.getElementById('showLoginBtn'),
      loginBtn=document.getElementById('loginBtn'),
      registerBtn=document.getElementById('registerBtn'),
      loginMessage=document.getElementById('loginMessage'),
      registerMessage=document.getElementById('registerMessage'),
      successMessage=document.getElementById('successMessage'),
      registeredPhoneSpan=document.getElementById('registeredPhone');

// åˆ‡æ¢è¡¨å•
showRegisterBtn.onclick=()=>{loginForm.style.display='none';registerForm.style.display='block'};
showLoginBtn.onclick=()=>{registerForm.style.display='none';loginForm.style.display='block';successMessage.style.display='none'};

// æ˜¾ç¤ºæ¶ˆæ¯
function showMsg(e,m,t){e.textContent=m;e.className='message '+t;e.style.display='block';setTimeout(()=>e.style.display='none',3000)}

// éªŒè¯æ‰‹æœºå·
function validPhone(p){return /^1[3-9]\d{9}$/.test(p)}

// ç”¨æˆ·æ•°æ®
function getUsers(){return JSON.parse(localStorage.getItem('users')||'[]')}
function saveUsers(u){localStorage.setItem('users',JSON.stringify(u))}

// æ³¨å†Œ
registerBtn.onclick=()=>{
    const phone=document.getElementById('registerPhone').value.trim(),
          pwd=document.getElementById('registerPassword').value.trim(),
          cpwd=document.getElementById('registerConfirmPassword').value.trim();
    
    if(!phone||!pwd||!cpwd)return showMsg(registerMessage,'è¯·å¡«å†™æ‰€æœ‰ä¿¡æ¯','error');
    if(!validPhone(phone))return showMsg(registerMessage,'è¯·è¾“å…¥æœ‰æ•ˆæ‰‹æœºå·','error');
    if(pwd.length<6)return showMsg(registerMessage,'å¯†ç è‡³å°‘6ä½','error');
    if(pwd!==cpwd)return showMsg(registerMessage,'ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´','error');
    
    const users=getUsers();
    if(users.some(u=>u.phone===phone))return showMsg(registerMessage,'æ‰‹æœºå·å·²æ³¨å†Œ','error');
    
    users.push({phone:phone,password:pwd,time:new Date().toLocaleString()});
    saveUsers(users);
    
    // æ˜¾ç¤ºæ³¨å†ŒæˆåŠŸä¿¡æ¯
    registeredPhoneSpan.textContent=phone;
    successMessage.style.display='block';
    registerBtn.style.display='none';
    
    // 3ç§’åè‡ªåŠ¨è¿”å›ç™»å½•
    setTimeout(()=>{
        registerForm.style.display='none';
        loginForm.style.display='block';
        successMessage.style.display='none';
        registerBtn.style.display='block';
        document.getElementById('loginPhone').value=phone;
    },3000);
}

// ç™»å½•
loginBtn.onclick=()=>{
    const phone=document.getElementById('loginPhone').value.trim(),
          pwd=document.getElementById('loginPassword').value.trim();
    
    if(!phone||!pwd)return showMsg(loginMessage,'è¯·è¾“å…¥æ‰‹æœºå·å’Œå¯†ç ','error');
    
    const users=getUsers();
    const user=users.find(u=>u.phone===phone&&u.password===pwd);
    
    if(user){
        showMsg(loginMessage,'ç™»å½•æˆåŠŸï¼è·³è½¬ä¸­...','success');
        localStorage.setItem('currentUser',JSON.stringify(user));
        setTimeout(()=>{
            window.location.href='dashboard.html';
        },1500);
    }else{
        showMsg(loginMessage,'æ‰‹æœºå·æˆ–å¯†ç é”™è¯¯','error');
    }
}
document.onkeypress=e=>{
    if(e.key==='Enter'){
        if(loginForm.style.display!=='none')loginBtn.click();
        else registerBtn.click();
    }
}
</script>
</body>
</html>
